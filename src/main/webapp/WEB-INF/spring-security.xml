<?xml version="1.0" encoding="UTF-8"?>
<bean:beans xmlns:bean="http://www.springframework.org/schema/beans"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xmlns="http://www.springframework.org/schema/security"
            xmlns:jdbc="http://www.springframework.org/schema/jdbc"
            xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
             http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.1.xsd
             http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc-3.1.xsd">

  <http pattern="/static/**" security="none"/>

  <http auto-config="true" use-expressions="true">


    <intercept-url pattern="/shop/specials/**" access="hasRole('ROLE_CASHCOW')"/>
    <intercept-url pattern="/shop/**" access="hasRole('ROLE_MEMBER')"/>

    <form-login login-page="/users/login-form.jsp"
                login-processing-url="/users/login"
                authentication-failure-url="/users/login-form.jsp?error"
                default-target-url="/shop"/>

    <logout logout-url="/users/logout"
            logout-success-url="/users/login-form.jsp?logout"/>
  </http>
  <authentication-manager>
    <authentication-provider>
     <jdbc-user-service data-source-ref="dataSource"/>
    </authentication-provider>
  </authentication-manager>

  <jdbc:embedded-database id="dataSource" type="H2">
    <jdbc:script location="classpath:schema.sql"/>
    <jdbc:script location="classpath:data.sql"/>
  </jdbc:embedded-database>
</bean:beans>