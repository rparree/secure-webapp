<?xml version="1.0" encoding="UTF-8"?>
<bean:beans xmlns:bean="http://www.springframework.org/schema/beans"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xmlns="http://www.springframework.org/schema/security"
            xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.1.xsd">

  <http pattern="/static/**" security="none"/>

  <http auto-config="true" use-expressions="true">


    <intercept-url pattern="/shop/specials/**" access="hasRole('ROLE_CASHCOW')"/>
    <intercept-url pattern="/shop/**" access="hasRole('ROLE_MEMBER')"/>

    <form-login login-page="/users/login-form.jsp"
                login-processing-url="/users/login"
                authentication-failure-url="/users/login-form.jsp?error"
                default-target-url="/shop"/>

    <logout logout-url="/users/logout"
            logout-success-url="/users/login-form.jsp?logout"/>
  </http>
  <authentication-manager>
    <authentication-provider>
      <user-service>
        <user name="jennifer" password="secret" authorities="ROLE_MEMBER, ROLE_CASHCOW"/>
        <user name="john" password="secret" authorities="ROLE_MEMBER"/>
      </user-service>
    </authentication-provider>
  </authentication-manager>
</bean:beans>